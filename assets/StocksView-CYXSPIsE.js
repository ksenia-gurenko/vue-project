import{u as C,s as R,a as f,b as V,c as x,d as o,e as S,f as $,_ as F}from"./card.esm-DqEtZe6c.js";import{d as L,r as d,o as T,c as p,b as s,g as v,h as U,u as a,i as l,j as g,k as y,t as k,e as c}from"./index-CjBSAxlk.js";const B={class:"container"},D={key:0,class:"error-message"},I={class:"filters"},q={class:"filter-group"},E={class:"filter-group"},O={class:"filter-group"},W={class:"filter-group"},j={class:"filter-actions"},M={key:1,class:"loading"},z={key:3,class:"result-info"},G={key:4,class:"no-data-message"},H=L({__name:"StocksView",setup(J){const b=C(),n=d([]),i=d(!1),h=d(1),w=d(10),P=d(0),t=d({supplierArticle:"",warehouseName:"",brand:"",category:""}),m=async(u=1)=>{i.value=!0;try{const e={page:u,limit:w.value,dateFrom:"2020-01-01",dateTo:new Date().toISOString().split("T")[0]};t.value.supplierArticle&&(e.supplierArticle=t.value.supplierArticle),t.value.warehouseName&&(e.warehouseName=t.value.warehouseName),t.value.brand&&(e.brand=t.value.brand),t.value.category&&(e.category=t.value.category);const r=await b.fetchData("stocks",e);n.value=r,P.value=r.length}catch(e){console.error("Error fetching stocks:",e)}finally{i.value=!1}},N=()=>{t.value={supplierArticle:"",warehouseName:"",brand:"",category:""},m(1)},_=u=>{h.value=u.page+1,m(h.value)},A=u=>new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB"}).format(u);return T(()=>m(1)),(u,e)=>(c(),p("div",B,[e[12]||(e[12]=s("h1",{class:"page-title"},"Склады",-1)),a(b).error?(c(),p("div",D,[l(a(R),{severity:"error"},{default:g(()=>[y("Ошибка API: "+k(a(b).error),1)]),_:1})])):v("",!0),s("div",I,[s("div",q,[e[5]||(e[5]=s("label",null,"Артикул:",-1)),l(a(f),{modelValue:t.value.supplierArticle,"onUpdate:modelValue":e[0]||(e[0]=r=>t.value.supplierArticle=r),placeholder:"Введите артикул"},null,8,["modelValue"])]),s("div",E,[e[6]||(e[6]=s("label",null,"Склад:",-1)),l(a(f),{modelValue:t.value.warehouseName,"onUpdate:modelValue":e[1]||(e[1]=r=>t.value.warehouseName=r),placeholder:"Введите склад"},null,8,["modelValue"])]),s("div",O,[e[7]||(e[7]=s("label",null,"Бренд:",-1)),l(a(f),{modelValue:t.value.brand,"onUpdate:modelValue":e[2]||(e[2]=r=>t.value.brand=r),placeholder:"Введите бренд"},null,8,["modelValue"])]),s("div",W,[e[8]||(e[8]=s("label",null,"Категория:",-1)),l(a(f),{modelValue:t.value.category,"onUpdate:modelValue":e[3]||(e[3]=r=>t.value.category=r),placeholder:"Введите категорию"},null,8,["modelValue"])]),s("div",j,[l(a(V),{label:"Применить фильтры",onClick:e[4]||(e[4]=r=>m(1)),loading:i.value,class:"orange-button"},null,8,["loading"]),l(a(V),{label:"Сбросить",onClick:N,severity:"secondary",text:""})])]),i.value?(c(),p("div",M,[l(a(x)),e[9]||(e[9]=s("span",null,"Загрузка данных...",-1))])):v("",!0),n.value.length>0?(c(),U(a(S),{key:2,value:n.value,paginator:"",rows:w.value,loading:i.value,totalRecords:P.value,onPage:_,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[10,20,50,100],currentPageReportTemplate:"Показано {first} - {last} из {totalRecords} записей",class:"orange-table"},{default:g(()=>[l(a(o),{field:"supplierArticle",header:"Артикул",sortable:""}),l(a(o),{field:"brand",header:"Бренд",sortable:""}),l(a(o),{field:"category",header:"Категория",sortable:""}),l(a(o),{field:"quantity",header:"Количество",sortable:""}),l(a(o),{field:"quantityFull",header:"Полное количество",sortable:""}),l(a(o),{field:"warehouseName",header:"Склад",sortable:""}),l(a(o),{field:"Price",header:"Цена",sortable:""},{body:g(({data:r})=>[y(k(A(r.Price)),1)]),_:1}),l(a(o),{field:"inWayToClient",header:"В пути к клиенту",sortable:""}),l(a(o),{field:"inWayFromClient",header:"В пути от клиенту",sortable:""})]),_:1},8,["value","rows","loading","totalRecords"])):v("",!0),n.value.length>0?(c(),p("div",z," Найдено записей: "+k(n.value.length),1)):v("",!0),!i.value&&n.value.length===0?(c(),p("div",G,[l(a($),null,{title:g(()=>e[10]||(e[10]=[y("Данные не найдены",-1)])),content:g(()=>e[11]||(e[11]=[s("p",null,"Попробуйте изменить параметры фильтрации.",-1)])),_:1})])):v("",!0)]))}}),X=F(H,[["__scopeId","data-v-0a95abcd"]]);export{X as default};
